define(["jquery"],function(l){return{scrollMargin:10,scrollMin:30,emulator:function(o){if(void 0===o)return console.log("Selector scroll is null"),!1;var i=o;"string"==typeof i&&(i=l(i)),0==i.hasClass("scroll-wrapper")?i=i.find("scroll-wrapper"):i.parent().hasClass("scroll-wrapper")&&(i=i.parent()),this.addScrollThumb(i),this.bindScrollThumb(i)},addScrollThumb:function(o){var i=o;"string"==typeof i&&(i=l(i));var r=i.find("div.scroll-vertical"),t=i.find("div.scroll-horizontal"),n=i.find("div.scroll-content");if(!n)return!1;(!r.length||r.length<=0)&&i.append('<div class="scroll-vertical"></div>'),(!t.length||t.length<=0)&&i.append('<div class="scroll-horizontal"></div>');var r=i.find("div.scroll-vertical"),t=i.find("div.scroll-horizontal"),s=n.get(0),e=n.get(0);s=s.scrollWidth?s.scrollWidth:this.scrollMin,e=e.scrollHeight?e.scrollHeight:this.scrollMin;var c=i.width()||n.width(),d=i.height()||n.outerHeight(),a=s/(c-(this.scrollMargin<<1)),h=e/(d-(this.scrollMargin<<1)),u=Math.ceil(c/a),g=Math.ceil(d/h);t.css({left:this.scrollMargin,width:u+"px"}),r.css({top:this.scrollMargin,height:g+"px"})},bindScrollThumb:function(o){var i=o;"string"==typeof i&&(i=l(i));var r=this,t=i.width(),n=i.height(),s=i.find("div.scroll-vertical"),e=i.find("div.scroll-horizontal"),c=i.find("div.scroll-content"),d=c.get(0),a=c.get(0),h=l(window),u=l(document),g=0,f=0,p=0,v=0,M=0,b=0,m=0,w=0,x=0,S=0,D=!1,y=!1;s&&e||this.addScrollThumb(i),d=d.scrollWidth-c.outerWidth(),a=a.scrollHeight-c.outerHeight(),c.unbind("DOMSubtreeModified DOMNodeInserted DOMNodeRemoved").bind("DOMSubtreeModified DOMNodeInserted DOMNodeRemoved",function(l){if(t=i.width(),n=i.height(),d=c.get(0).scrollWidth-t,a=c.get(0).scrollHeight-n,r.addScrollThumb(i),r.checkScroll(o),0==D){var h=c.scrollLeft()/d,u=t-e.width()-(r.scrollMargin<<1);e.css({left:Math.floor(h*u+r.scrollMargin)+"px"})}if(0==y){var g=c.scrollTop()/a,f=n-s.height()-(r.scrollMargin<<1);s.css({top:Math.floor(g*f+r.scrollMargin)+"px"})}}),this.checkScroll(o),e.unbind("mousedown").bind("mousedown",function(l){l.preventDefault(),u.unbind("mouseup").bind("mouseup",function(l){l.preventDefault(),h.unbind("mousemove"),u.unbind("mouseup"),g=0,f=0,D=!1}),D=!0,h.unbind("mousemove").bind("mousemove",function(l){g=l.pageX,M=e.css("left"),b=r.scrollMargin,m=t-e.width()-r.scrollMargin,-1!==M.indexOf("px")&&(M=M.substr(0,M.length-2)),0===f&&(f=g),M=parseInt(M),g<f?M-=f-g:g>f&&(M+=g-f),M<=b&&(M=b),M>=m&&(M=m),e.css({left:M+"px"}),c.scrollLeft((M-r.scrollMargin)/(m-r.scrollMargin)*d),f=g})}),s.unbind("mousedown").bind("mousedown",function(l){l.preventDefault(),u.unbind("mouseup").bind("mouseup",function(l){l.preventDefault(),h.unbind("mousemove"),u.unbind("mouseup"),p=0,v=0,y=!1}),y=!0,h.unbind("mousemove").bind("mousemove",function(l){p=l.pageY,w=s.css("top"),x=r.scrollMargin,S=n-s.height()-r.scrollMargin,-1!==w.indexOf("px")&&(w=w.substr(0,w.length-2)),0===v&&(v=p),w=parseInt(w),p<v?w-=v-p:p>v&&(w+=p-v),w<x&&(w=x),w>S&&(w=S),s.css({top:w+"px"}),c.scrollTop((w-r.scrollMargin)/(S-r.scrollMargin)*a),v=p})}),c.unbind("scroll").bind("scroll",function(){if(0==D){var l=c.scrollLeft()/d,o=t-e.width()-(r.scrollMargin<<1);e.css({left:Math.floor(l*o+r.scrollMargin)+"px"})}if(0==y){var i=c.scrollTop()/a,h=n-s.height()-(r.scrollMargin<<1);s.css({top:Math.floor(i*h+r.scrollMargin)+"px"})}})},checkScroll:function(o){var i=o;"string"==typeof i&&(i=l(i));var r=i.find("div.scroll-vertical"),t=i.find("div.scroll-horizontal"),n=i.find("div.scroll-content");n.get(0).scrollWidth<=n.outerWidth()?t.css({opacity:0}):t.css({opacity:1}),n.get(0).scrollHeight<=n.outerHeight()?r.css({opacity:0}):r.css({opacity:1})}}});